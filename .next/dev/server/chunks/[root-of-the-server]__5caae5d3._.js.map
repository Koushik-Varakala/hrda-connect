{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/shared/models/auth.ts"],"sourcesContent":["import { sql } from \"drizzle-orm\";\nimport { index, jsonb, pgTable, timestamp, varchar } from \"drizzle-orm/pg-core\";\n\n// Session storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)]\n);\n\n// User storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;;;AAIO,MAAM,WAAW,IAAA,kKAAO,EAC7B,YACA;IACE,KAAK,IAAA,+KAAO,EAAC,OAAO,UAAU;IAC9B,MAAM,IAAA,2KAAK,EAAC,QAAQ,OAAO;IAC3B,QAAQ,IAAA,mLAAS,EAAC,UAAU,OAAO;AACrC,GACA,CAAC,QAAU;QAAC,IAAA,kKAAK,EAAC,sBAAsB,EAAE,CAAC,MAAM,MAAM;KAAE;AAKpD,MAAM,QAAQ,IAAA,kKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,OAAO,IAAA,+KAAO,EAAC,SAAS,MAAM;IAC9B,WAAW,IAAA,+KAAO,EAAC;IACnB,UAAU,IAAA,+KAAO,EAAC;IAClB,iBAAiB,IAAA,+KAAO,EAAC;IACzB,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;IAC7C,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/shared/schema.ts"],"sourcesContent":["import { pgTable, text, serial, boolean, timestamp, varchar, date, json, integer } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nexport * from \"./models/auth\";\n\n// === TABLE DEFINITIONS ===\n\nexport const sessions = pgTable(\"session\", {\n  sid: varchar(\"sid\").primaryKey(),\n  sess: json(\"sess\").notNull(),\n  expire: timestamp(\"expire\", { precision: 6 }).notNull(),\n});\n\nexport const announcements = pgTable(\"announcements\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  date: date(\"date\").notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const panels = pgTable(\"panels\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  role: text(\"role\").notNull(),\n  district: text(\"district\"), // null for state level\n  isStateLevel: boolean(\"is_state_level\").default(false).notNull(),\n  imageUrl: text(\"image_url\"),\n  phone: text(\"phone\"),\n  priority: serial(\"priority\"), // for ordering\n  category: text(\"category\").default('state_executive'), // 'state_executive', 'elected_member'\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const achievements = pgTable(\"achievements\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  date: date(\"date\"),\n  imageUrl: text(\"image_url\"),\n  category: text(\"category\").default('association').notNull(), // 'association', 'legal', 'post_election', 'legacy'\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const mediaCoverage = pgTable(\"media_coverage\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  date: date(\"date\"),\n  imageUrl: text(\"image_url\").notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const departments = pgTable(\"departments\", {\n  id: serial(\"id\").primaryKey(),\n  type: text(\"type\").notNull(), // 'academic', 'sports', 'culture'\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Cache/Mirror of registrations for search & verification\nexport const registrations = pgTable(\"registrations\", {\n  id: serial(\"id\").primaryKey(),\n  hrdaId: text(\"hrda_id\"), // Added field for HRDA Registration Number\n  tgmcId: text(\"tgmc_id\"), // Can be null if not yet assigned\n  firstName: text(\"first_name\").notNull(),\n  lastName: text(\"last_name\").notNull(),\n  email: text(\"email\"),\n  phone: text(\"phone\").notNull(),\n  address: text(\"address\"),\n  district: text(\"district\"),\n  membershipType: text(\"membership_type\").default('single'), // single, couple\n  paymentStatus: text(\"payment_status\").default('pending'), // pending, success, failed\n  razorpayTxnId: text(\"razorpay_txn_id\"),\n  registrationSource: text(\"registration_source\").default('site_contact'),\n  status: text(\"status\").default('pending_verification'), // pending_verification, verified, rejected\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n  // OTP Verification fields\n  otpCode: text(\"otp_code\"),\n  otpExpiresAt: timestamp(\"otp_expires_at\"),\n  otpAttempts: integer(\"otp_attempts\").default(0),\n});\n\n// === SCHEMAS ===\n\nexport const insertAnnouncementSchema = createInsertSchema(announcements).omit({ id: true, createdAt: true });\nexport const insertPanelSchema = createInsertSchema(panels).omit({ id: true });\nexport const insertAchievementSchema = createInsertSchema(achievements).omit({ id: true });\nexport const insertMediaCoverageSchema = createInsertSchema(mediaCoverage).omit({ id: true });\nexport const insertDepartmentSchema = createInsertSchema(departments).omit({ id: true, updatedAt: true });\nexport const insertRegistrationSchema = createInsertSchema(registrations).omit({ id: true, createdAt: true, updatedAt: true });\n\n// === EXPLICIT API TYPES ===\n\n// Announcements\nexport type Announcement = typeof announcements.$inferSelect;\nexport type InsertAnnouncement = z.infer<typeof insertAnnouncementSchema>;\nexport type CreateAnnouncementRequest = InsertAnnouncement;\nexport type UpdateAnnouncementRequest = Partial<InsertAnnouncement>;\n\n// Panels\nexport type Panel = typeof panels.$inferSelect;\nexport type InsertPanel = z.infer<typeof insertPanelSchema>;\nexport type CreatePanelRequest = InsertPanel;\nexport type UpdatePanelRequest = Partial<InsertPanel>;\n\n// Achievements\nexport type Achievement = typeof achievements.$inferSelect;\nexport type InsertAchievement = z.infer<typeof insertAchievementSchema>;\nexport type CreateAchievementRequest = InsertAchievement;\nexport type UpdateAchievementRequest = Partial<InsertAchievement>;\n\n// Media Coverage\nexport type MediaCoverage = typeof mediaCoverage.$inferSelect;\nexport type InsertMediaCoverage = z.infer<typeof insertMediaCoverageSchema>;\nexport type CreateMediaCoverageRequest = InsertMediaCoverage;\nexport type UpdateMediaCoverageRequest = Partial<InsertMediaCoverage>;\n\n// Departments\nexport type Department = typeof departments.$inferSelect;\nexport type InsertDepartment = z.infer<typeof insertDepartmentSchema>;\nexport type UpdateDepartmentRequest = Partial<InsertDepartment>;\n\n// Registrations\nexport type Registration = typeof registrations.$inferSelect;\nexport type InsertRegistration = z.infer<typeof insertRegistrationSchema>;\nexport type CreateRegistrationRequest = InsertRegistration;\nexport type UpdateRegistrationRequest = Partial<InsertRegistration>;\n\n// Search Params\nexport interface SearchRegistrationParams {\n  tgmcId?: string;\n  phone?: string;\n}\n\nexport type RegistrationSearchResponse = Registration[];\n// Election Documents\nexport const electionDocuments = pgTable(\"election_documents\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  category: text(\"category\").notNull(), // 'Foundational', 'Candidates', 'Notices', 'Ballots', 'Results', 'Records'\n  filename: text(\"filename\").notNull(),\n  date: text(\"date\").notNull(), // Display date string e.g. \"Jan 11, 2026\"\n  active: boolean(\"active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertElectionDocumentSchema = createInsertSchema(electionDocuments).omit({ id: true, createdAt: true });\n\nexport type ElectionDocument = typeof electionDocuments.$inferSelect;\nexport type InsertElectionDocument = z.infer<typeof insertElectionDocumentSchema>;\nexport type CreateElectionDocumentRequest = InsertElectionDocument;\nexport type UpdateElectionDocumentRequest = Partial<InsertElectionDocument>;\n\n// Gallery Photos\nexport const galleryPhotos = pgTable(\"gallery_photos\", {\n  id: serial(\"id\").primaryKey(),\n  url: text(\"url\").notNull(),\n  title: text(\"title\"),\n  description: text(\"description\"),\n  active: boolean(\"active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertGalleryPhotoSchema = createInsertSchema(galleryPhotos).omit({ id: true, createdAt: true });\n\nexport type GalleryPhoto = typeof galleryPhotos.$inferSelect;\nexport type InsertGalleryPhoto = z.infer<typeof insertGalleryPhotoSchema>;\nexport type CreateGalleryPhotoRequest = InsertGalleryPhoto;\nexport type UpdateGalleryPhotoRequest = Partial<InsertGalleryPhoto>;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 301, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/lib/db.ts"],"sourcesContent":["import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\n// import ws from \"ws\"; // Removed for Next.js edge/serverless compatibility\nimport * as schema from \"@shared/schema\";\n\n// neonConfig.webSocketConstructor = ws; // Not needed for HTTP-based serverless driver\n\nif (!process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL must be set. Did you forget to provision a database?\");\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA,4EAA4E;AAC5E;AAAA;;;;AAEA,uFAAuF;AAEvF,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC3B,MAAM,IAAI,MAAM;AACpB;AAEO,MAAM,OAAO,IAAI,gKAAI,CAAC;IAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAAC;AACnE,MAAM,KAAK,IAAA,2KAAO,EAAC,MAAM;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 329, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/lib/storage.ts"],"sourcesContent":["import { db } from \"./db\";\nimport {\n    announcements, panels, achievements, departments, registrations, mediaCoverage,\n    type Announcement, type InsertAnnouncement, type UpdateAnnouncementRequest,\n    type Panel, type InsertPanel, type UpdatePanelRequest,\n    type Achievement, type InsertAchievement, type UpdateAchievementRequest,\n    type MediaCoverage, type InsertMediaCoverage, type UpdateMediaCoverageRequest,\n    type Department, type UpdateDepartmentRequest,\n    type Registration, type InsertRegistration, type UpdateRegistrationRequest, type SearchRegistrationParams,\n    electionDocuments, type ElectionDocument, type InsertElectionDocument,\n    galleryPhotos, type GalleryPhoto, type InsertGalleryPhoto\n} from \"@shared/schema\";\nimport { eq, desc, and, ilike } from \"drizzle-orm\";\n\nexport interface IStorage {\n    // Announcements\n    getAnnouncements(): Promise<Announcement[]>;\n    createAnnouncement(announcement: InsertAnnouncement): Promise<Announcement>;\n    updateAnnouncement(id: number, updates: UpdateAnnouncementRequest): Promise<Announcement | undefined>;\n    deleteAnnouncement(id: number): Promise<void>;\n\n    // Panels\n    getPanels(type?: 'state' | 'district', district?: string): Promise<Panel[]>;\n    getPanel(id: number): Promise<Panel | undefined>;\n    createPanel(panel: InsertPanel): Promise<Panel>;\n    updatePanel(id: number, updates: UpdatePanelRequest): Promise<Panel | undefined>;\n    deletePanel(id: number): Promise<void>;\n\n    // Achievements\n    getAchievements(category?: string): Promise<Achievement[]>;\n    getAchievement(id: number): Promise<Achievement | undefined>;\n    createAchievement(achievement: InsertAchievement): Promise<Achievement>;\n    updateAchievement(id: number, updates: UpdateAchievementRequest): Promise<Achievement | undefined>;\n    deleteAchievement(id: number): Promise<void>;\n\n    // Departments\n    getDepartments(): Promise<Department[]>;\n    updateDepartment(id: number, updates: UpdateDepartmentRequest): Promise<Department | undefined>;\n\n    // Registrations\n    searchRegistrations(params: SearchRegistrationParams): Promise<Registration[]>;\n    getRegistration(id: number): Promise<Registration | undefined>;\n    createRegistration(registration: InsertRegistration): Promise<Registration>;\n    updateRegistration(id: number, updates: UpdateRegistrationRequest): Promise<Registration | undefined>;\n    deleteRegistration(id: number): Promise<void>;\n    getRegistrations(): Promise<Registration[]>;\n\n    // Media Coverage\n    getMediaCoverage(): Promise<MediaCoverage[]>;\n    getMediaCoverageById(id: number): Promise<MediaCoverage | undefined>;\n    createMediaCoverage(media: InsertMediaCoverage): Promise<MediaCoverage>;\n    updateMediaCoverage(id: number, updates: UpdateMediaCoverageRequest): Promise<MediaCoverage | undefined>;\n    deleteMediaCoverage(id: number): Promise<void>;\n\n    // Election Documents\n    getElectionDocuments(): Promise<ElectionDocument[]>;\n    createElectionDocument(doc: InsertElectionDocument): Promise<ElectionDocument>;\n    deleteElectionDocument(id: number): Promise<void>;\n\n    // Gallery\n    getGalleryPhotos(): Promise<GalleryPhoto[]>;\n    getGalleryPhoto(id: number): Promise<GalleryPhoto | undefined>;\n    createGalleryPhoto(photo: InsertGalleryPhoto): Promise<GalleryPhoto>;\n    deleteGalleryPhoto(id: number): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n    // Announcements\n    async getAnnouncements(): Promise<Announcement[]> {\n        return await db.select().from(announcements).orderBy(desc(announcements.date));\n    }\n\n    async createAnnouncement(insert: InsertAnnouncement): Promise<Announcement> {\n        const [result] = await db.insert(announcements).values(insert).returning();\n        return result;\n    }\n\n    async updateAnnouncement(id: number, updates: UpdateAnnouncementRequest): Promise<Announcement | undefined> {\n        const [result] = await db.update(announcements).set(updates).where(eq(announcements.id, id)).returning();\n        return result;\n    }\n\n    async deleteAnnouncement(id: number): Promise<void> {\n        await db.delete(announcements).where(eq(announcements.id, id));\n    }\n\n    // Panels\n    async getPanels(type?: 'state' | 'district', district?: string): Promise<Panel[]> {\n        let query = db.select().from(panels);\n        if (type === 'state') {\n            // @ts-ignore\n            query.where(eq(panels.isStateLevel, true));\n        } else if (type === 'district') {\n            // @ts-ignore\n            query.where(eq(panels.isStateLevel, false));\n            if (district) {\n                // @ts-ignore\n                query.where(and(eq(panels.isStateLevel, false), eq(panels.district, district)));\n            }\n        }\n        return await query.orderBy(panels.priority);\n    }\n\n    async getPanel(id: number): Promise<Panel | undefined> {\n        const [result] = await db.select().from(panels).where(eq(panels.id, id));\n        return result;\n    }\n\n    async createPanel(insert: InsertPanel): Promise<Panel> {\n        const [result] = await db.insert(panels).values(insert).returning();\n        return result;\n    }\n\n    async updatePanel(id: number, updates: UpdatePanelRequest): Promise<Panel | undefined> {\n        const [result] = await db.update(panels).set(updates).where(eq(panels.id, id)).returning();\n        return result;\n    }\n\n    async deletePanel(id: number): Promise<void> {\n        await db.delete(panels).where(eq(panels.id, id));\n    }\n\n    // Achievements\n    async getAchievements(category?: string): Promise<Achievement[]> {\n        let query = db.select().from(achievements);\n        if (category) {\n            query.where(eq(achievements.category, category));\n        }\n        return await query.orderBy(desc(achievements.date));\n    }\n\n    async getAchievement(id: number): Promise<Achievement | undefined> {\n        const [result] = await db.select().from(achievements).where(eq(achievements.id, id));\n        return result;\n    }\n\n    async createAchievement(insert: InsertAchievement): Promise<Achievement> {\n        const [result] = await db.insert(achievements).values(insert).returning();\n        return result;\n    }\n\n    async updateAchievement(id: number, updates: UpdateAchievementRequest): Promise<Achievement | undefined> {\n        const [result] = await db.update(achievements).set(updates).where(eq(achievements.id, id)).returning();\n        return result;\n    }\n\n    async deleteAchievement(id: number): Promise<void> {\n        await db.delete(achievements).where(eq(achievements.id, id));\n    }\n\n    // Departments\n    async getDepartments(): Promise<Department[]> {\n        return await db.select().from(departments);\n    }\n\n    async updateDepartment(id: number, updates: UpdateDepartmentRequest): Promise<Department | undefined> {\n        const [result] = await db.update(departments).set(updates).where(eq(departments.id, id)).returning();\n        return result;\n    }\n\n    // Registrations\n    async searchRegistrations(params: SearchRegistrationParams): Promise<Registration[]> {\n        if (params.tgmcId) {\n            return await db.select().from(registrations).where(eq(registrations.tgmcId, params.tgmcId));\n        }\n        if (params.phone) {\n            return await db.select().from(registrations).where(eq(registrations.phone, params.phone));\n        }\n        return [];\n    }\n\n    async getRegistration(id: number): Promise<Registration | undefined> {\n        const [registration] = await db.select().from(registrations).where(eq(registrations.id, id));\n        return registration;\n    }\n\n    async createRegistration(insert: InsertRegistration): Promise<Registration> {\n        const [result] = await db.insert(registrations).values(insert).returning();\n        return result;\n    }\n\n    async updateRegistration(id: number, updates: UpdateRegistrationRequest): Promise<Registration | undefined> {\n        const [result] = await db.update(registrations).set(updates).where(eq(registrations.id, id)).returning();\n        return result;\n    }\n\n    async deleteRegistration(id: number): Promise<void> {\n        await db.delete(registrations).where(eq(registrations.id, id));\n    }\n\n    async getRegistrations(): Promise<Registration[]> {\n        return await db.select().from(registrations).orderBy(desc(registrations.createdAt));\n    }\n\n    // Media Coverage\n    async getMediaCoverage(): Promise<MediaCoverage[]> {\n        return await db.select().from(mediaCoverage).orderBy(desc(mediaCoverage.date));\n    }\n\n    async getMediaCoverageById(id: number): Promise<MediaCoverage | undefined> {\n        const [result] = await db.select().from(mediaCoverage).where(eq(mediaCoverage.id, id));\n        return result;\n    }\n\n    async createMediaCoverage(insert: InsertMediaCoverage): Promise<MediaCoverage> {\n        const [result] = await db.insert(mediaCoverage).values(insert).returning();\n        return result;\n    }\n\n    async updateMediaCoverage(id: number, updates: UpdateMediaCoverageRequest): Promise<MediaCoverage | undefined> {\n        const [result] = await db.update(mediaCoverage).set(updates).where(eq(mediaCoverage.id, id)).returning();\n        return result;\n    }\n\n    async deleteMediaCoverage(id: number): Promise<void> {\n        await db.delete(mediaCoverage).where(eq(mediaCoverage.id, id));\n    }\n\n    // Election Documents\n    async getElectionDocuments(): Promise<ElectionDocument[]> {\n        return await db.select().from(electionDocuments).orderBy(electionDocuments.id);\n    }\n\n    async createElectionDocument(insert: InsertElectionDocument): Promise<ElectionDocument> {\n        const [result] = await db.insert(electionDocuments).values(insert).returning();\n        return result;\n    }\n\n    async deleteElectionDocument(id: number): Promise<void> {\n        await db.delete(electionDocuments).where(eq(electionDocuments.id, id));\n    }\n\n    // Gallery\n    async getGalleryPhotos(): Promise<GalleryPhoto[]> {\n        return await db.select().from(galleryPhotos).where(eq(galleryPhotos.active, true)).orderBy(desc(galleryPhotos.createdAt));\n    }\n\n    async getGalleryPhoto(id: number): Promise<GalleryPhoto | undefined> {\n        const [result] = await db.select().from(galleryPhotos).where(eq(galleryPhotos.id, id));\n        return result;\n    }\n\n    async createGalleryPhoto(insert: InsertGalleryPhoto): Promise<GalleryPhoto> {\n        const [result] = await db.insert(galleryPhotos).values(insert).returning();\n        return result;\n    }\n\n    async deleteGalleryPhoto(id: number): Promise<void> {\n        await db.delete(galleryPhotos).where(eq(galleryPhotos.id, id));\n    }\n}\n\nexport const storage = new DatabaseStorage();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/lib/services/googleSheets.ts"],"sourcesContent":["import { GoogleSpreadsheet } from \"google-spreadsheet\";\nimport { JWT } from \"google-auth-library\";\n\nexport interface SheetRegistration {\n    id: string; // Used for tracking locally\n    tgmcId: string;\n    firstName: string;\n    lastName: string;\n    phone: string;\n    email: string;\n    address: string;\n    membershipType: string;\n    paymentStatus: string;\n    status: string;\n    registrationDate: string;\n    updatedAt: string;\n    rowStatus: 'Active' | 'Updated';\n    district?: string;\n    anotherMobile?: string;\n}\n\nexport class GoogleSheetsService {\n    private doc: GoogleSpreadsheet | null = null;\n    private isConnected = false;\n    private initPromise: Promise<void>;\n\n    constructor() {\n        this.initPromise = this.initialize();\n        this.initPromise.catch(err => {\n            console.error(\"Failed to initialize Google Sheets service:\", err.message);\n        });\n    }\n\n    private async initialize() {\n        if (!process.env.GOOGLE_SHEETS_ID || !process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL || !process.env.GOOGLE_PRIVATE_KEY) {\n            console.log(\"Google Sheets credentials missing. Running in mock mode.\");\n            return;\n        }\n\n        try {\n            const jwt = new JWT({\n                email: process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL,\n                key: process.env.GOOGLE_PRIVATE_KEY.replace(/\\\\n/g, '\\n'),\n                scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n            });\n\n            this.doc = new GoogleSpreadsheet(process.env.GOOGLE_SHEETS_ID, jwt);\n            await this.doc.loadInfo();\n            this.isConnected = true;\n            console.log(`Connected to Google Sheet: ${this.doc.title}`);\n        } catch (error: any) {\n            console.error(\"Google Sheets connection error DETAILS:\", error);\n            if (error.response) {\n                console.error(\"API Error Response:\", error.response.data);\n            }\n        }\n    }\n\n    private formatDate(isoString: string): string {\n        try {\n            const date = new Date(isoString);\n            return `${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}/${date.getFullYear()}`;\n        } catch {\n            return isoString;\n        }\n    }\n\n    async appendRegistration(data: SheetRegistration): Promise<string | null> {\n        await this.initPromise;\n\n        if (!this.isConnected || !this.doc) {\n            const hrdaId = `HRDA-MOCK-${data.id}`;\n            console.log(`[Mock] Appending registration to sheet: ${data.firstName} ${data.lastName} (${data.tgmcId}) - Generated ID: ${hrdaId}`);\n            return hrdaId;\n        }\n\n        try {\n            const sheet = this.doc.sheetsByIndex[0];\n\n            // 1. Fetch existing rows to calculate new ID\n            const rows = await sheet.getRows();\n            let lastSNo = 0;\n\n            if (rows.length > 0) {\n                const lastRow = rows[rows.length - 1];\n                const sno = parseInt(lastRow.get('S.No') || '0');\n                if (!isNaN(sno)) lastSNo = sno;\n            }\n\n            const newSNo = lastSNo + 1;\n\n            // 2. Generate HRDA ID\n            const date = new Date();\n            const month = String(date.getMonth() + 1).padStart(2, '0');\n            const year = date.getFullYear();\n            const sequenceStr = String(newSNo).padStart(4, '0');\n            const hrdaId = `HRDA${month}${year}-${sequenceStr}`;\n\n            await sheet.addRow({\n                \"S.No\": newSNo,\n                \"Name\": `${data.firstName} ${data.lastName}`,\n                \"DateofRegistration\": this.formatDate(data.registrationDate),\n                \"ContactNumber\": data.phone,\n                \"MailID\": data.email,\n                \"MedicalCounselRegistration\": data.tgmcId,\n                \"HRDAREGISTRATIONNUMBER\": hrdaId,\n                \"PaymentStatus\": data.paymentStatus,\n                \"Address\": data.address,\n                \"District\": data.district || \"\",\n                \"AnotherMobileNumber\": data.anotherMobile || \"\"\n            });\n            console.log(`Successfully appended row for ${data.firstName} with ID ${hrdaId}`);\n\n            return hrdaId;\n        } catch (error: any) {\n            console.error(\"Failed to append row to Google Sheet DETAILS:\", error);\n            if (error.response) {\n                console.error(\"API Error Response:\", error.response.data);\n            }\n            return null;\n        }\n    }\n\n    async findRegistrationByTGMC(tgmcId: string): Promise<any | null> {\n        await this.initPromise;\n\n        if (!this.isConnected || !this.doc) {\n            console.log(`[Mock] Finding registration by TGMC: ${tgmcId}`);\n            return null;\n        }\n\n        try {\n            const sheet = this.doc.sheetsByIndex[0];\n            const rows = await sheet.getRows();\n            const row = rows.reverse().find(r => r.get(\"MedicalCounselRegistration\") === tgmcId);\n\n            if (!row) return null;\n\n            return {\n                id: row.get(\"S.No\"),\n                hrdaId: row.get(\"HRDAREGISTRATIONNUMBER\"),\n                tgmcId: row.get(\"MedicalCounselRegistration\"),\n                firstName: row.get(\"Name\"),\n                lastName: \"\",\n                phone: row.get(\"ContactNumber\"),\n                email: row.get(\"MailID\"),\n                address: row.get(\"Address\"),\n                district: row.get(\"District\")\n            };\n        } catch (error) {\n            console.error(\"Error searching Google Sheet:\", error);\n            return null;\n        }\n    }\n\n    async findRegistrationByPhone(phone: string): Promise<any | null> {\n        await this.initPromise;\n\n        if (!this.isConnected || !this.doc) {\n            console.log(`[Mock] Finding registration by Phone: ${phone}`);\n            return null;\n        }\n\n        try {\n            const sheet = this.doc.sheetsByIndex[0];\n            const rows = await sheet.getRows();\n            const row = rows.reverse().find(r => r.get(\"ContactNumber\") === phone);\n\n            if (!row) return null;\n\n            return {\n                id: row.get(\"S.No\"),\n                hrdaId: row.get(\"HRDAREGISTRATIONNUMBER\"),\n                tgmcId: row.get(\"MedicalCounselRegistration\"),\n                firstName: row.get(\"Name\"),\n                phone: row.get(\"ContactNumber\"),\n                email: row.get(\"MailID\"),\n                address: row.get(\"Address\"),\n                district: row.get(\"District\")\n            };\n        } catch (error) {\n            console.error(\"Error searching Google Sheet by Phone:\", error);\n            return null;\n        }\n    }\n\n    async updateRegistration(tgmcId: string, newData: Partial<SheetRegistration>): Promise<boolean> {\n        await this.initPromise;\n\n        if (!this.isConnected || !this.doc) {\n            console.log(`[Mock] Updating registration for TGMC: ${tgmcId}`);\n            return true;\n        }\n\n        try {\n            const sheet = this.doc.sheetsByIndex[0];\n            const rows = await sheet.getRows();\n            const row = rows.find(r => r.get(\"MedicalCounselRegistration\") === tgmcId);\n\n            if (row) {\n                if (newData.phone) row.set(\"ContactNumber\", newData.phone);\n                if (newData.email) row.set(\"MailID\", newData.email);\n                if (newData.address) row.set(\"Address\", newData.address);\n                if (newData.district) row.set(\"District\", newData.district);\n                if (newData.anotherMobile) row.set(\"AnotherMobileNumber\", newData.anotherMobile);\n\n                await row.save();\n                return true;\n            }\n            return false;\n        } catch (error) {\n            console.error(\"Error updating Google Sheet:\", error);\n            return false;\n        }\n    }\n}\n\nexport const googleSheetsService = new GoogleSheetsService();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 790, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/lib/services/email.ts"],"sourcesContent":["import nodemailer from \"nodemailer\";\n\nexport interface EmailOptions {\n    to: string;\n    subject: string;\n    text: string;\n}\n\nexport class EmailService {\n    private transporter: nodemailer.Transporter | null = null;\n\n    constructor() {\n        if (process.env.SMTP_HOST && process.env.SMTP_USER && process.env.SMTP_PASS) {\n            this.transporter = nodemailer.createTransport({\n                host: process.env.SMTP_HOST,\n                port: parseInt(process.env.SMTP_PORT || \"587\"),\n                secure: process.env.SMTP_SECURE === \"true\", // true for 465, false for other ports\n                auth: {\n                    user: process.env.SMTP_USER,\n                    pass: process.env.SMTP_PASS,\n                },\n            });\n            console.log(`[EmailService] Configured with SMTP host: ${process.env.SMTP_HOST}`);\n        } else {\n            console.log(\"[EmailService] SMTP credentials missing. Emails will be mocked.\");\n        }\n    }\n\n    async sendEmail(options: EmailOptions): Promise<boolean> {\n        const apiKey = process.env.SMTP_PASS;\n        const useBrevoApi = apiKey && apiKey.startsWith(\"xkeysib-\");\n\n        if (useBrevoApi) {\n            try {\n                const response = await fetch(\"https://api.brevo.com/v3/smtp/email\", {\n                    method: \"POST\",\n                    headers: {\n                        \"accept\": \"application/json\",\n                        \"api-key\": apiKey,\n                        \"content-type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        sender: { email: process.env.SMTP_USER || \"no-reply@hrdaconnect.com\", name: \"HRDA Telangana\" },\n                        to: [{ email: options.to }],\n                        subject: options.subject,\n                        textContent: options.text\n                    })\n                });\n\n                if (!response.ok) {\n                    const error = await response.text();\n                    console.error(\"[EmailService] Brevo API Error:\", error);\n                    return false;\n                }\n\n                console.log(`[EmailService] Sent email to ${options.to} via Brevo API`);\n                return true;\n            } catch (error) {\n                console.error(\"[EmailService] Error sending via Brevo API:\", error);\n                return false;\n            }\n        }\n\n        if (!this.transporter) {\n            console.log(`[Mock Email] To: ${options.to} | Subject: ${options.subject} | Body: ${options.text}`);\n            return true;\n        }\n\n        try {\n            await this.transporter.sendMail({\n                from: process.env.SMTP_FROM || '\"HRDA Connect\" <no-reply@hrdaconnect.com>',\n                to: options.to,\n                subject: options.subject,\n                text: options.text,\n            });\n            console.log(`[EmailService] Sent email to ${options.to}`);\n            return true;\n        } catch (error) {\n            console.error(\"[EmailService] Error sending email:\", error);\n            return false;\n        }\n    }\n\n    async sendRegistrationConfirmation(to: string, name: string, tgmcId: string, hrdaId: number | string, phone: string, address: string) {\n        return this.sendEmail({\n            to,\n            subject: \"HRDA Registration Successful - Welcome to the Family\",\n            text: `Dear ${name},\n\nCongratulations! You have successfully registered with HRDA Telangana.\n\nHere are your membership details:\n------------------------------------------------\nName: ${name}\nHRDA Membership ID: ${hrdaId}\nTGMC Registration ID: ${tgmcId}\nMobile Number: ${phone}\nEmail Address: ${to}\nAddress: ${address}\n------------------------------------------------\n\nThank you for strengthening our voice. We look forward to your active participation.\n\nRegards,\nHRDA Team`\n        });\n    }\n\n    async sendOtp(to: string, otp: string) {\n        return this.sendEmail({\n            to,\n            subject: \"HRDA Verification Code\",\n            text: `Your verification code is: ${otp}\n\nThis code will expire in 5 minutes. Do not share this code with anyone.\n\nIf you did not request this code, please ignore this email.`\n        });\n    }\n    async sendContactMessage(data: { firstName: string, lastName: string, email: string, subject: string, message: string }) {\n        const adminEmail = process.env.CONTACT_EMAIL || \"hrda4people@gmail.com\";\n\n        return this.sendEmail({\n            to: adminEmail,\n            subject: `[Contact Form] ${data.subject} - ${data.firstName} ${data.lastName}`,\n            text: `You have received a new message from the HRDA Connect contact form.\n\nFrom: ${data.firstName} ${data.lastName}\nEmail: ${data.email}\nSubject: ${data.subject}\n\nMessage:\n${data.message}\n\n------------------------------------------------\nPlease reply directly to ${data.email}\n`\n        });\n    }\n}\n\nexport const emailService = new EmailService();\n"],"names":[],"mappings":";;;;;;AAAA;;AAQO,MAAM;IACD,cAA6C,KAAK;IAE1D,aAAc;QACV,IAAI,QAAQ,GAAG,CAAC,SAAS,IAAI,QAAQ,GAAG,CAAC,SAAS,IAAI,QAAQ,GAAG,CAAC,SAAS,EAAE;YACzE,IAAI,CAAC,WAAW,GAAG,4JAAU,CAAC,eAAe,CAAC;gBAC1C,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC3B,MAAM,SAAS,QAAQ,GAAG,CAAC,SAAS,IAAI;gBACxC,QAAQ,QAAQ,GAAG,CAAC,WAAW,KAAK;gBACpC,MAAM;oBACF,MAAM,QAAQ,GAAG,CAAC,SAAS;oBAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;gBAC/B;YACJ;YACA,QAAQ,GAAG,CAAC,CAAC,0CAA0C,EAAE,QAAQ,GAAG,CAAC,SAAS,EAAE;QACpF,OAAO;YACH,QAAQ,GAAG,CAAC;QAChB;IACJ;IAEA,MAAM,UAAU,OAAqB,EAAoB;QACrD,MAAM,SAAS,QAAQ,GAAG,CAAC,SAAS;QACpC,MAAM,cAAc,UAAU,OAAO,UAAU,CAAC;QAEhD,IAAI,aAAa;YACb,IAAI;gBACA,MAAM,WAAW,MAAM,MAAM,uCAAuC;oBAChE,QAAQ;oBACR,SAAS;wBACL,UAAU;wBACV,WAAW;wBACX,gBAAgB;oBACpB;oBACA,MAAM,KAAK,SAAS,CAAC;wBACjB,QAAQ;4BAAE,OAAO,QAAQ,GAAG,CAAC,SAAS,IAAI;4BAA4B,MAAM;wBAAiB;wBAC7F,IAAI;4BAAC;gCAAE,OAAO,QAAQ,EAAE;4BAAC;yBAAE;wBAC3B,SAAS,QAAQ,OAAO;wBACxB,aAAa,QAAQ,IAAI;oBAC7B;gBACJ;gBAEA,IAAI,CAAC,SAAS,EAAE,EAAE;oBACd,MAAM,QAAQ,MAAM,SAAS,IAAI;oBACjC,QAAQ,KAAK,CAAC,mCAAmC;oBACjD,OAAO;gBACX;gBAEA,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,QAAQ,EAAE,CAAC,cAAc,CAAC;gBACtE,OAAO;YACX,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,+CAA+C;gBAC7D,OAAO;YACX;QACJ;QAEA,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACnB,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,QAAQ,EAAE,CAAC,YAAY,EAAE,QAAQ,OAAO,CAAC,SAAS,EAAE,QAAQ,IAAI,EAAE;YAClG,OAAO;QACX;QAEA,IAAI;YACA,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;gBAC5B,MAAM,QAAQ,GAAG,CAAC,SAAS,IAAI;gBAC/B,IAAI,QAAQ,EAAE;gBACd,SAAS,QAAQ,OAAO;gBACxB,MAAM,QAAQ,IAAI;YACtB;YACA,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,QAAQ,EAAE,EAAE;YACxD,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,uCAAuC;YACrD,OAAO;QACX;IACJ;IAEA,MAAM,6BAA6B,EAAU,EAAE,IAAY,EAAE,MAAc,EAAE,MAAuB,EAAE,KAAa,EAAE,OAAe,EAAE;QAClI,OAAO,IAAI,CAAC,SAAS,CAAC;YAClB;YACA,SAAS;YACT,MAAM,CAAC,KAAK,EAAE,KAAK;;;;;;MAMzB,EAAE,KAAK;oBACO,EAAE,OAAO;sBACP,EAAE,OAAO;eAChB,EAAE,MAAM;eACR,EAAE,GAAG;SACX,EAAE,QAAQ;;;;;;SAMV,CAAC;QACF;IACJ;IAEA,MAAM,QAAQ,EAAU,EAAE,GAAW,EAAE;QACnC,OAAO,IAAI,CAAC,SAAS,CAAC;YAClB;YACA,SAAS;YACT,MAAM,CAAC,2BAA2B,EAAE,IAAI;;;;2DAIO,CAAC;QACpD;IACJ;IACA,MAAM,mBAAmB,IAA8F,EAAE;QACrH,MAAM,aAAa,QAAQ,GAAG,CAAC,aAAa,IAAI;QAEhD,OAAO,IAAI,CAAC,SAAS,CAAC;YAClB,IAAI;YACJ,SAAS,CAAC,eAAe,EAAE,KAAK,OAAO,CAAC,GAAG,EAAE,KAAK,SAAS,CAAC,CAAC,EAAE,KAAK,QAAQ,EAAE;YAC9E,MAAM,CAAC;;MAEb,EAAE,KAAK,SAAS,CAAC,CAAC,EAAE,KAAK,QAAQ,CAAC;OACjC,EAAE,KAAK,KAAK,CAAC;SACX,EAAE,KAAK,OAAO,CAAC;;;AAGxB,EAAE,KAAK,OAAO,CAAC;;;yBAGU,EAAE,KAAK,KAAK,CAAC;AACtC,CAAC;QACO;IACJ;AACJ;AAEO,MAAM,eAAe,IAAI"}},
    {"offset": {"line": 932, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/lib/services/sms.ts"],"sourcesContent":["export class SmsService {\n    private isConfigured = false;\n\n    constructor() {\n        // Check for SMS config (e.g., Twilio, SNS, Fast2SMS)\n        // if (process.env.SMS_API_KEY) this.isConfigured = true;\n    }\n\n    async sendSms(to: string, message: string): Promise<boolean> {\n        const apiKey = process.env.FAST2SMS_API_KEY;\n\n        if (!apiKey) {\n            console.log(`[Mock SMS] To: ${to} | Message: ${message}`);\n            return true;\n        }\n\n        try {\n            const response = await fetch(\"https://www.fast2sms.com/dev/bulkV2\", {\n                method: \"POST\",\n                headers: {\n                    \"authorization\": apiKey,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    \"route\": \"q\",\n                    \"message\": message,\n                    \"language\": \"english\",\n                    \"flash\": 0,\n                    \"numbers\": to\n                })\n            });\n\n            const data = await response.json();\n\n            if (data.return) {\n                console.log(`[Fast2SMS] Sent SMS to ${to}: ${message}`);\n                return true;\n            } else {\n                console.error(\"[Fast2SMS] Error:\", data.message);\n                return false;\n            }\n        } catch (error) {\n            console.error(\"[Fast2SMS] Request Failed:\", error);\n            return false;\n        }\n    }\n\n    async sendRegistrationSuccess(to: string, name: string, hrdaId: number | string) {\n        // Keep it short for SMS\n        const message = `Dear ${name}, Welcome to HRDA! Registration Successful. Member ID: ${hrdaId}. Thank you via HRDA Telangana.`;\n        return this.sendSms(to, message);\n    }\n}\n\nexport const smsService = new SmsService();\n"],"names":[],"mappings":";;;;;;AAAO,MAAM;IACD,eAAe,MAAM;IAE7B,aAAc;IACV,qDAAqD;IACrD,yDAAyD;IAC7D;IAEA,MAAM,QAAQ,EAAU,EAAE,OAAe,EAAoB;QACzD,MAAM,SAAS,QAAQ,GAAG,CAAC,gBAAgB;QAE3C,IAAI,CAAC,QAAQ;YACT,QAAQ,GAAG,CAAC,CAAC,eAAe,EAAE,GAAG,YAAY,EAAE,SAAS;YACxD,OAAO;QACX;QAEA,IAAI;YACA,MAAM,WAAW,MAAM,MAAM,uCAAuC;gBAChE,QAAQ;gBACR,SAAS;oBACL,iBAAiB;oBACjB,gBAAgB;gBACpB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACjB,SAAS;oBACT,WAAW;oBACX,YAAY;oBACZ,SAAS;oBACT,WAAW;gBACf;YACJ;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,KAAK,MAAM,EAAE;gBACb,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,GAAG,EAAE,EAAE,SAAS;gBACtD,OAAO;YACX,OAAO;gBACH,QAAQ,KAAK,CAAC,qBAAqB,KAAK,OAAO;gBAC/C,OAAO;YACX;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,OAAO;QACX;IACJ;IAEA,MAAM,wBAAwB,EAAU,EAAE,IAAY,EAAE,MAAuB,EAAE;QAC7E,wBAAwB;QACxB,MAAM,UAAU,CAAC,KAAK,EAAE,KAAK,uDAAuD,EAAE,OAAO,+BAA+B,CAAC;QAC7H,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI;IAC5B;AACJ;AAEO,MAAM,aAAa,IAAI"}},
    {"offset": {"line": 989, "column": 0}, "map": {"version":3,"sources":["file:///Users/KoushikVarakala/Downloads/HRDA-Connect/app/api/registrations/verify/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { storage } from \"@/lib/storage\";\nimport { insertRegistrationSchema } from \"@shared/schema\";\nimport { googleSheetsService } from \"@/lib/services/googleSheets\";\nimport { emailService } from \"@/lib/services/email\";\nimport { smsService } from \"@/lib/services/sms\";\n\n\n// api.registrations.create.input is likely just Zod schema from shared/schema\n// import { insertRegistrationSchema } from \"@shared/schema\"; // Already imported\n\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const { razorpay_order_id, razorpay_payment_id, razorpay_signature, userData } = body;\n\n        // Skip signature verification for mock/MVP if needed, or implement it\n        // ...\n\n        const regInput = insertRegistrationSchema.parse({\n            ...userData,\n            paymentStatus: 'success',\n            status: 'verified',\n            razorpayTxnId: razorpay_payment_id\n        });\n\n        const newReg = await storage.createRegistration(regInput);\n        let formattedHrdaId: string | number = newReg.id;\n\n        // Sync to Sheets\n        try {\n            const sheetId = await googleSheetsService.appendRegistration({\n                id: String(newReg.id),\n                tgmcId: newReg.tgmcId || \"\",\n                firstName: newReg.firstName,\n                lastName: newReg.lastName,\n                phone: newReg.phone,\n                email: newReg.email || \"\",\n                address: newReg.address || \"\",\n                district: newReg.district || \"\",\n                membershipType: newReg.membershipType || \"single\",\n                paymentStatus: \"success\",\n                status: \"verified\",\n                registrationDate: new Date().toISOString(),\n                updatedAt: new Date().toISOString(),\n                rowStatus: \"Active\"\n            });\n\n            if (sheetId) {\n                formattedHrdaId = sheetId;\n                await storage.updateRegistration(newReg.id, { hrdaId: String(formattedHrdaId) });\n            }\n        } catch (e) {\n            console.error(\"Failed to sync to sheets\", e);\n        }\n\n        // Email\n        try {\n            if (newReg.email) {\n                await emailService.sendRegistrationConfirmation(\n                    newReg.email,\n                    `${newReg.firstName} ${newReg.lastName}`,\n                    newReg.tgmcId || \"N/A\",\n                    formattedHrdaId,\n                    newReg.phone,\n                    newReg.address || \"\"\n                );\n            }\n        } catch (e) {\n            console.error(\"Failed to send email\", e);\n        }\n\n        // SMS\n        try {\n            if (newReg.phone) {\n                await smsService.sendRegistrationSuccess(newReg.phone, newReg.firstName, formattedHrdaId);\n            }\n        } catch (e) {\n            console.error(\"Failed to send SMS\", e);\n        }\n\n        return NextResponse.json({ success: true, registrationId: newReg.id, hrdaId: formattedHrdaId });\n\n    } catch (error: any) {\n        console.error(\"Verification Error:\", error);\n        return NextResponse.json({ message: \"Verification failed\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAMO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,iBAAiB,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,QAAQ,EAAE,GAAG;QAEjF,sEAAsE;QACtE,MAAM;QAEN,MAAM,WAAW,8JAAwB,CAAC,KAAK,CAAC;YAC5C,GAAG,QAAQ;YACX,eAAe;YACf,QAAQ;YACR,eAAe;QACnB;QAEA,MAAM,SAAS,MAAM,2HAAO,CAAC,kBAAkB,CAAC;QAChD,IAAI,kBAAmC,OAAO,EAAE;QAEhD,iBAAiB;QACjB,IAAI;YACA,MAAM,UAAU,MAAM,wJAAmB,CAAC,kBAAkB,CAAC;gBACzD,IAAI,OAAO,OAAO,EAAE;gBACpB,QAAQ,OAAO,MAAM,IAAI;gBACzB,WAAW,OAAO,SAAS;gBAC3B,UAAU,OAAO,QAAQ;gBACzB,OAAO,OAAO,KAAK;gBACnB,OAAO,OAAO,KAAK,IAAI;gBACvB,SAAS,OAAO,OAAO,IAAI;gBAC3B,UAAU,OAAO,QAAQ,IAAI;gBAC7B,gBAAgB,OAAO,cAAc,IAAI;gBACzC,eAAe;gBACf,QAAQ;gBACR,kBAAkB,IAAI,OAAO,WAAW;gBACxC,WAAW,IAAI,OAAO,WAAW;gBACjC,WAAW;YACf;YAEA,IAAI,SAAS;gBACT,kBAAkB;gBAClB,MAAM,2HAAO,CAAC,kBAAkB,CAAC,OAAO,EAAE,EAAE;oBAAE,QAAQ,OAAO;gBAAiB;YAClF;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,4BAA4B;QAC9C;QAEA,QAAQ;QACR,IAAI;YACA,IAAI,OAAO,KAAK,EAAE;gBACd,MAAM,0IAAY,CAAC,4BAA4B,CAC3C,OAAO,KAAK,EACZ,GAAG,OAAO,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,EAAE,EACxC,OAAO,MAAM,IAAI,OACjB,iBACA,OAAO,KAAK,EACZ,OAAO,OAAO,IAAI;YAE1B;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,wBAAwB;QAC1C;QAEA,MAAM;QACN,IAAI;YACA,IAAI,OAAO,KAAK,EAAE;gBACd,MAAM,sIAAU,CAAC,uBAAuB,CAAC,OAAO,KAAK,EAAE,OAAO,SAAS,EAAE;YAC7E;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,sBAAsB;QACxC;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,gBAAgB,OAAO,EAAE;YAAE,QAAQ;QAAgB;IAEjG,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}